<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- BEGIN NETSA-DOXYGEN HEADER -->
<head>
<title>Airframe Application Utilities</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!-- All pages must include the following stylesheets -->
<link rel="stylesheet" type="text/css" href="doxygen.css">
<link rel="stylesheet" type="text/css" href="tabs.css">
<link rel="stylesheet" type="text/css" href="tools.css">
</head>       
<!--#include virtual="/tools-page-header.shtml"-->

<body>
<div class="tool-header">
<div class="bigtext">Airframe Application Utilities</div>
libairframe 0.7.2 API documentation
</div>
<!-- END NETSA-DOXYGEN HEADER -->

<div class="page-content">   
<br />
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>privconfig.h File Reference</h1>Airframe Privilege Configuration Support. <a href="#_details">More...</a>
<p>
<code>#include &lt;airframe/autoinc.h&gt;</code><br>
<code>#include &lt;<a class="el" href="airopt_8h-source.html">airframe/airopt.h</a>&gt;</code><br>

<p>
<a href="privconfig_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a0" doxytag="privconfig.h::PRIVC_ERROR_DOMAIN"></a>
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a0">PRIVC_ERROR_DOMAIN</a>&nbsp;&nbsp;&nbsp;g_quark_from_string("airframePrivilegeError")</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">GError domain for privconfig errors. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a1">PRIVC_ERROR_SETUP</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Privconfig setup error.  <a href="#a1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a2" doxytag="privconfig.h::PRIVC_ERROR_FAILED"></a>
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a2">PRIVC_ERROR_FAILED</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Privilege drop error. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a3" doxytag="privconfig.h::PRIVC_ERROR_ALREADY"></a>
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a3">PRIVC_ERROR_ALREADY</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Couldn't drop privilege because privilege already dropped. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a4" doxytag="privconfig.h::PRIVC_ERROR_NODROP"></a>
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a4">PRIVC_ERROR_NODROP</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Won't drop privilege because not running as root. <br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a5">privc_add_option_group</a> (<a class="el" href="airopt_8h.html#a0">AirOptionCtx</a> *aoctx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return an option group for privilege configuration.  <a href="#a5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a6">privc_setup</a> (GError **err)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set up privilege configuration.  <a href="#a6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a7">privc_configured</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine if the user wants to drop privileges.  <a href="#a7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a8">privc_become</a> (GError **err)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Drop privileges if necessary.  <a href="#a8"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Airframe Privilege Configuration Support. 
<p>
Supplies privilege dropping for post-root initialization reduction of privileges (e.g. for live packet capture applications) and the command line option processing necessary to use it. Use this when you want to drop privileges after doing one-time setup as root.<hr><h2>Define Documentation</h2>
<a class="anchor" name="a1" doxytag="privconfig.h::PRIVC_ERROR_SETUP"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define PRIVC_ERROR_SETUP&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Privconfig setup error. 
<p>
Signifies that setup failed because of bad command line options.     </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a5" doxytag="privconfig.h::privc_add_option_group"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">gboolean privc_add_option_group           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="airopt_8h.html#a0">AirOptionCtx</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>aoctx</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return an option group for privilege configuration. 
<p>
This option group defines two options: --become-user (-U) to become a specified user by name, and --become-group to additionally specify a group to become (otherwise, drops privileges to the given user's default group.)<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>aoctx</em>&nbsp;</td><td>airframe option context </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>TRUE if successful, FALSE otherwise </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="privconfig.h::privc_become"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">gboolean privc_become           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">GError **&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>err</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Drop privileges if necessary. 
<p>
Returns TRUE if not running as root. Returns FALSE if running as root with no --become-user option with PRIVC_ERROR_NODROP, or if <a class="el" href="privconfig_8h.html#a8">privc_become()</a> was already called succsssfully with PRIVC_ERROR_ALREADY. If for some reason a required privilege drop fails, returns FALSE with PRIVC_ERROR_FAILED.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error description </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE otherwise </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="privconfig.h::privc_configured"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">gboolean privc_configured           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Determine if the user wants to drop privileges. 
<p>
Use this to determine whether warn the user if the application will not call priv_become() due to some application-specific state.<p>
<dl compact><dt><b>Returns:</b></dt><dd>TRUE if --become-user supplied on command line. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="privconfig.h::privc_setup"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">gboolean privc_setup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">GError **&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>err</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set up privilege configuration. 
<p>
Call this after parsing an options context including a GOptionGroup returned from privc_option_group(). This sets up internal state used by the other privconfig calls.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error description </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE otherwise </dd></dl>
    </td>
  </tr>
</table>
</div>

<!-- BEGIN NETSA-TOOLS FOOTER -->
<div class="page-footer">
<!-- INCLUDE THE FOOTER CONTENT -->

<div class="copyright">
This library is part of the 
<a href="http://tools.netsa.cert.org">NetSA Security Suite</a>,                                                      
developed by the <a href="http://www.cert.org">CERT</a>
<a href="http://www.cert.org/netsa">NetSA</a> group<br>
at the <a href="http://www.sei.cmu.edu">Software Engineering Institute</a>   
at <a href="http://www.cmu.edu">Carnegie Mellon University</a>.
<br>
<br>
&copy; 2006-2008 Carnegie Mellon University </div>
</div>
<!-- END NETSA-TOOLS FOOTER -->       

</body>
</html>   
