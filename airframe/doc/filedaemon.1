.\" Automatically generated by Pod::Man 4.09 (Pod::Simple 3.35)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.if !\nF .nr F 0
.if \nF>0 \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    if !\nF==2 \{\
.        nr % 0
.        nr F 2
.    \}
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "FILEDAEMON 1"
.TH FILEDAEMON 1 "%v" "2.9.4" "airframe"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
filedaemon \- Invoke another program on files matching a glob pattern
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 9
\&    filedaemon  \-\-in INPUT_GLOB [\-\-out OUTPUT_DIR]
\&                \-\-nextdir PROCESSED_INPUT_DIRECTORY
\&                \-\-faildir FAILED_INPUT_DIRECTORY
\&                [\-\-extension OUTPUT_EXTENSION]
\&                [\-\-poll POLLING_DELAY] [\-\-lock]
\&                [\-\-pidfile PID_FILE] [\-\-no\-daemon]
\&                [\-\-log LOG_SPECIFIER] [\-\-loglevel LOG_LEVEL]
\&                [\-\-verbose] [\-\-version]
\&                \-\- PROGRAM [PROGRAM_ARGS]
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fBfiledaemon\fR operates on input files matching a \fIglob\fR\|(3) pattern.  Each matching
input file is passed to a child program (specified in the \s-1PROGRAM\s0 argument)
which is expected to read input data from standard input and write the results
to standard output.  \fBfiledaemon\fR's job is simply to handle the mechanics of
directory polling, file globbing, and routing of input and output files on
behalf of the child program.
.PP
Use of two dashes (\-\-) after all filedaemon command-line switches allows
\&\s-1PROGRAM_ARGS\s0 to be interpreted by the \s-1PROGRAM\s0 rather than \fBfiledaemon\fR itself.
While they are not strictly required if you do not need to pass arguments to
\&\s-1PROGRAM,\s0 they should be used for consistency.
.SH "OPTIONS"
.IX Header "OPTIONS"
.SS "I/O Options"
.IX Subsection "I/O Options"
These options control the file locations for input and output files.
.IP "\fB\-\-in\fR \fI\s-1INPUT_GLOB\s0\fR" 4
.IX Item "--in INPUT_GLOB"
\&\fI\s-1INPUT_GLOB\s0\fR is a file glob pattern, which must be  escaped or quoted to
prevent the shell expansion.  Files that match this pattern will be processed
by filedaemon.  This option is required.
.IP "\fB\-\-out\fR \fI\s-1OUTPUT_DIR\s0\fR" 4
.IX Item "--out OUTPUT_DIR"
\&\fI\s-1OUTPUT_DIR\s0\fR is a directory in which to place output files.  The directory
must exist prior to invoking \fBfiledaemon\fR, and any files in the directory
that match the names of output files will be overwritten.  If not specified,
the current working directory will be used.
.SS "Daemon Options"
.IX Subsection "Daemon Options"
These options control what is done with processed input files, file locking,
and other options to facilitate operation as a file daemon.
.IP "\fB\-\-nextdir\fR \fI\s-1PROCESSED_INPUT_DIRECTORY\s0\fR" 4
.IX Item "--nextdir PROCESSED_INPUT_DIRECTORY"
When reading from files, if this option is present, input files will be 
moved to \fI\s-1PROCESSED_INPUT_DIRECTORY\s0\fR after they are successfully processed. 
The special string \fBdelete\fR will cause successfully processed input to be 
removed instead. This option is required.
.IP "\fB\-\-faildir\fR \fI\s-1FAILED_INPUT_DIRECTORY\s0\fR" 4
.IX Item "--faildir FAILED_INPUT_DIRECTORY"
When reading from files, if this option is present, input files will be 
moved to \fI\s-1FAILED_INPUT_DIRECTORY\s0\fR if processing failed. 
The special string \fBdelete\fR will cause failed input to be 
removed instead. This option is required.
.IP "\fB\-\-extension\fR \fI\s-1OUTPUT_EXTENSION\s0\fR" 4
.IX Item "--extension OUTPUT_EXTENSION"
Replace the input file's extension with \fI\s-1OUTPUT_EXTENSION\s0\fR.  For
example, if an input file is named \*(L"foo.txt\*(R", and this option is \*(L"out\*(R",
then the output file will be named \*(L"foo.out\*(R".  If the input file has no
extension, then this option's value will be appended to the filename. 
If this option is not specified, output files will have the same name
as input files, except in the case when the \fB\-\-out\fR option is also not
specified, in which case output files will be given a .out extension to
avoid clobbering input files.
.IP "\fB\-\-poll\fR \fI\s-1POLLING_DELAY\s0\fR" 4
.IX Item "--poll POLLING_DELAY"
\&\fI\s-1POLLING_DELAY\s0\fR is the polling delay in seconds; how long filedaemon will 
wait for new input when none is available. The default is 30 seconds.
.IP "\fB\-\-lock\fR" 4
.IX Item "--lock"
Use lockfiles for concurrent file access protection.  filedaemon will not
process an input file for which a lock file exists, but will do so when the
lock file is removed.  Lock files are written to the same directory as the
input file, and the filename is the input filename (including any extensions)
with \*(L".lock\*(R" appended.
.IP "\fB\-\-pidfile\fR=\fI\s-1PIDFILE\s0\fR" 4
.IX Item "--pidfile=PIDFILE"
Write the process identifier of the filedaemon process to \fI\s-1PIDFILE\s0\fR. 
This option exists to facilitate the termination of the forked
filedaemon process by shutdown scripts.
.IP "\fB\-\-no\-daemon\fR" 4
.IX Item "--no-daemon"
Do not actually daemonize.  Mainly useful for testing/debugging.
.SS "Logging Options"
.IX Subsection "Logging Options"
These options are used to specify how log messages are routed.  filedaemon can 
log to standard error, regular files, or the \s-1UNIX\s0 syslog facility.
.IP "\fB\-\-log\fR \fI\s-1LOG_SPECIFIER\s0\fR" 4
.IX Item "--log LOG_SPECIFIER"
Specifies destination for log messages. \fI\s-1LOG_SPECIFIER\s0\fR can be a \fIsyslog\fR\|(3)
facility name, the special value \fBstderr\fR for standard error, or the 
\&\fIabsolute\fR path to a file for file logging. Standard error logging is only 
available in \fB\-\-daemon\fR mode if \fB\-\-foreground\fR is present. The default log 
specifier is \fBstderr\fR if available, \fBuser\fR otherwise.
.IP "\fB\-\-loglevel\fR \fI\s-1LOG_LEVEL\s0\fR" 4
.IX Item "--loglevel LOG_LEVEL"
Specify minimum level for logged messages. In increasing levels of verbosity, 
the supported log levels are \fBquiet\fR, \fBerror\fR, \fBcritical\fR, \fBwarning\fR, 
\&\fBmessage\fR, \fBinfo\fR, and \fBdebug\fR. The default logging level is \fBwarning\fR.
.IP "\fB\-\-verbose\fR" 4
.IX Item "--verbose"
Equivalent to \fB\-\-loglevel debug\fR.
.IP "\fB\-\-version\fR" 4
.IX Item "--version"
If present, print version and copyright information to standard error and exit.
.SH "EXAMPLES"
.IX Header "EXAMPLES"
The following will invoke \*(L"yaf\*(R" on .pcap files in the /in directory,
writing results to the /out directory with a .yaf extension.  Processed
input files will be moved to the /next directory, and failed input
files will be moved to the /fail directory.
.PP
.Vb 2
\&    filedaemon \-i "/in/*.txt" \-o /out \-e yaf \e
\&        \-\-nextdir /next \-\-faildir /fail \-\- yaf
.Ve
.PP
The same as the first example, but with all input files deleted after
processing:
.PP
.Vb 2
\&    filedaemon \-i "/in/*.txt" \-o /out \-e yaf \e
\&        \-\-nextdir delete \-\-faildir delete \-\- yaf
.Ve
.PP
The same as the first example, but with a polling delay of 10 seconds
(instead of the default 30) and an additional \-\-mac parameter passed to
yaf:
.PP
.Vb 2
\&    filedaemon \-i "/in/*.txt" \-o /out \-e yaf \-p 10 \e
\&        \-\-nextdir /next \-\-faildir /fail \-\- yaf \-\-mac
.Ve
.SH "BUGS"
.IX Header "BUGS"
Known issues are listed in the \fB\s-1README\s0\fR file in the Airframe source 
distribution. Note that Airframe should be considered alpha-quality software;
not  every concievable input and aggregation is exhaustively tested at each 
release, and specific features may be completely untested. Please be mindful 
of this before deploying Airframe in production environments. Bug reports and 
feature requests may be sent via email to <netsa\-help@cert.org>.
.SH "AUTHORS"
.IX Header "AUTHORS"
Tony Cebzanov and  Brian Trammell for 
the \s-1CERT\s0 Network Situational  Awareness
Group, http://www.cert.org/netsa
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIglob\fR\|(3), \fIairdaemon\fR\|(1)
