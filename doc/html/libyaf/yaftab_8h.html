<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>YAF - Documentation</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <link rel="stylesheet" type="text/css" href="doxygen.css">
        <link rel="stylesheet" type="text/css" href="../../site/style.css" />
        <link rel="stylesheet" type="text/css" href="tabs.css">
</head>
<body>
    <div id="p-body">
      <div id="l-header">
        <img src="../../site/sei-logo.png" id="l-sei-logo"
            alt="Software Engineering Institute | Carnegie Mellon&copy;" />
        <div id="l-netsa-logo"><a id="l-netsa-name" href="../../index.html"><b>CERT NetSA Security Suite</b></a></div>
        <div id="l-netsa-motto">Monitoring for Large-Scale Networks</div>
        <h1 class="l-page-title">YAF</h1>
        <span id="l-subtitle">Documentation</span>
      </div><!-- l-header -->
      <div id="l-content">
        <div id="l-sidebar">
          <div class="p-sidebar-section">
            <h1><a href="index.html">YAF</a></h1>
            <ul>
              <li><a href="../docs.html">Documentation</a></li>
              <li><a href="../download.html">Downloads</a></li>
            </ul>
          </div><!-- p-sidebar-section -->
        </div><!-- l-sidebar -->
      <div id="top"> <!-- need this for doxygen -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Tutorials</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_615759f7aa2b23f9d732a2fd184cb668.html">yaf</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">yaftab.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;yaf/autoinc.h&gt;</code><br />
<code>#include &lt;<a class="el" href="yafcore_8h_source.html">yaf/yafcore.h</a>&gt;</code><br />
<code>#include &lt;yaf/decode.h&gt;</code><br />
</div>
<p><a href="yaftab_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:af996afca1a47dc95ab0f00253b774256"><td class="memItemLeft" align="right" valign="top">typedef struct yfFlowTab_st&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a></td></tr>
<tr class="memdesc:af996afca1a47dc95ab0f00253b774256"><td class="mdescLeft">&#160;</td><td class="mdescRight">A flow table.  <a href="#af996afca1a47dc95ab0f00253b774256">More...</a><br /></td></tr>
<tr class="separator:af996afca1a47dc95ab0f00253b774256"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a270b166611ccdb1e647ac9597f038227"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yaftab_8h.html#a270b166611ccdb1e647ac9597f038227">yfFlowTabAlloc</a> (uint64_t idle_ms, uint64_t active_ms, uint32_t max_flows, uint32_t max_payload, gboolean uniflow, gboolean silkmode, gboolean macmode, gboolean applabelmode, gboolean entropymode, gboolean fingerprintmode, gboolean fpExportMode, gboolean udp_max_payload, uint16_t udp_uniflow_port, char *pcap_dir, char *pcap_meta_file, uint64_t max_pcap, gboolean pcap_per_flow, gboolean force_read_all, gboolean stats_mode, gboolean index_pcap, gboolean no_vlan_in_key, gboolean ndpi, char *ndpi_proto_file, char *hash, char *stime, void **hfctx)</td></tr>
<tr class="memdesc:a270b166611ccdb1e647ac9597f038227"><td class="mdescLeft">&#160;</td><td class="mdescRight">yfFlowTabAlloc  <a href="#a270b166611ccdb1e647ac9597f038227">More...</a><br /></td></tr>
<tr class="separator:a270b166611ccdb1e647ac9597f038227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a561a2425c34f20c77c9237ca6e9812d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yaftab_8h.html#a561a2425c34f20c77c9237ca6e9812d4">yfFlowTabFree</a> (<a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *flowtab)</td></tr>
<tr class="memdesc:a561a2425c34f20c77c9237ca6e9812d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a previously allocated flow table.  <a href="#a561a2425c34f20c77c9237ca6e9812d4">More...</a><br /></td></tr>
<tr class="separator:a561a2425c34f20c77c9237ca6e9812d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a416a4a18ac082b8d90c3f303b2d48329"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yaftab_8h.html#a416a4a18ac082b8d90c3f303b2d48329">yfUpdateRollingPcapFile</a> (<a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *flowtab, char *new_file_name)</td></tr>
<tr class="memdesc:a416a4a18ac082b8d90c3f303b2d48329"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the Pcap Filename in the Flowtab for pcap meta data output.  <a href="#a416a4a18ac082b8d90c3f303b2d48329">More...</a><br /></td></tr>
<tr class="separator:a416a4a18ac082b8d90c3f303b2d48329"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c9736e80ac4b9e1f99c9eeaf6f51bef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yaftab_8h.html#a8c9736e80ac4b9e1f99c9eeaf6f51bef">yfGetFlowTabStats</a> (<a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *flowtab, uint64_t *packets, uint64_t *flows, uint64_t *rej_pkts, uint32_t *peak, uint32_t *flush)</td></tr>
<tr class="memdesc:a8c9736e80ac4b9e1f99c9eeaf6f51bef"><td class="mdescLeft">&#160;</td><td class="mdescRight">yfGetFlowTabStats Get Flow Table Stats for Export  <a href="#a8c9736e80ac4b9e1f99c9eeaf6f51bef">More...</a><br /></td></tr>
<tr class="separator:a8c9736e80ac4b9e1f99c9eeaf6f51bef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37f151a4c4f8428eaf11655ec54be64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yaftab_8h.html#ab37f151a4c4f8428eaf11655ec54be64">yfFlowPBuf</a> (<a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *flowtab, size_t pbuflen, <a class="el" href="structyf_p_buf__st.html">yfPBuf_t</a> *pbuf)</td></tr>
<tr class="memdesc:ab37f151a4c4f8428eaf11655ec54be64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a decoded packet buffer to a given flow table.  <a href="#ab37f151a4c4f8428eaf11655ec54be64">More...</a><br /></td></tr>
<tr class="separator:ab37f151a4c4f8428eaf11655ec54be64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a423cb1a664ab1bffc3c5a87f184215"><td class="memItemLeft" align="right" valign="top">gboolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yaftab_8h.html#a6a423cb1a664ab1bffc3c5a87f184215">yfFlowTabFlush</a> (void *yfContext, gboolean close, GError **err)</td></tr>
<tr class="memdesc:a6a423cb1a664ab1bffc3c5a87f184215"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flush closed flows in the given flow table to the given IPFIX Message Buffer.  <a href="#a6a423cb1a664ab1bffc3c5a87f184215">More...</a><br /></td></tr>
<tr class="separator:a6a423cb1a664ab1bffc3c5a87f184215"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a53e42d3ae005b47da77a6e4a6695e0"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yaftab_8h.html#a1a53e42d3ae005b47da77a6e4a6695e0">yfFlowTabCurrentTime</a> (<a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *flowtab)</td></tr>
<tr class="memdesc:a1a53e42d3ae005b47da77a6e4a6695e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current packet clock from a flow table.  <a href="#a1a53e42d3ae005b47da77a6e4a6695e0">More...</a><br /></td></tr>
<tr class="separator:a1a53e42d3ae005b47da77a6e4a6695e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbb808b2cd98fa85bfc95c5b5515d2ae"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yaftab_8h.html#acbb808b2cd98fa85bfc95c5b5515d2ae">yfFlowDumpStats</a> (<a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *flowtab, GTimer *timer)</td></tr>
<tr class="memdesc:acbb808b2cd98fa85bfc95c5b5515d2ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print flow table statistics to the log.  <a href="#acbb808b2cd98fa85bfc95c5b5515d2ae">More...</a><br /></td></tr>
<tr class="separator:acbb808b2cd98fa85bfc95c5b5515d2ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Flow generation interface for YAF. </p>
<p>[TODO - frontmatter]</p>
<p>This facility is used by YAF to assemble packets into flows. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="af996afca1a47dc95ab0f00253b774256"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct yfFlowTab_st <a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A flow table. </p>
<p>Opaque. Create with <a class="el" href="yaftab_8h.html#a270b166611ccdb1e647ac9597f038227" title="yfFlowTabAlloc ">yfFlowTabAlloc()</a> and free with <a class="el" href="yaftab_8h.html#a561a2425c34f20c77c9237ca6e9812d4" title="Free a previously allocated flow table. ">yfFlowTabFree()</a>. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="acbb808b2cd98fa85bfc95c5b5515d2ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t yfFlowDumpStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *&#160;</td>
          <td class="paramname"><em>flowtab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GTimer *&#160;</td>
          <td class="paramname"><em>timer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print flow table statistics to the log. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flowtab</td><td>flow table to dump stats for </td></tr>
    <tr><td class="paramname">timer</td><td>a GTimer containing the runtime (for packet and flow rate logging). May be NULL to suppress rate logging. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab37f151a4c4f8428eaf11655ec54be64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfFlowPBuf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *&#160;</td>
          <td class="paramname"><em>flowtab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pbuflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_p_buf__st.html">yfPBuf_t</a> *&#160;</td>
          <td class="paramname"><em>pbuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a decoded packet buffer to a given flow table. </p>
<p>Adds the packet to the flow to which it belongs, creating a new flow if necessary. Causes the flow to which it belongs to time out if it is longer than the active timeout. Closes the flow if the flow closure conditions (TCP RST, TCP FIN four-way teardown) are met.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flowtab</td><td>flow table to add the packet to </td></tr>
    <tr><td class="paramname">pbuflen</td><td>size of the packet buffer pbuf </td></tr>
    <tr><td class="paramname">pbuf</td><td>packet buffer containing decoded packet to add. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a270b166611ccdb1e647ac9597f038227"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a>* yfFlowTabAlloc </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>idle_ms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>active_ms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>max_flows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>max_payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>uniflow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>silkmode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>macmode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>applabelmode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>entropymode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>fingerprintmode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>fpExportMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>udp_max_payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>udp_uniflow_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pcap_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pcap_meta_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>max_pcap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>pcap_per_flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>force_read_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>stats_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>index_pcap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>no_vlan_in_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>ndpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ndpi_proto_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>stime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>hfctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>yfFlowTabAlloc </p>
<p>Allocate a flow table.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">idle_ms</td><td>idle timeout in milliseconds. A flow that receives no packets for the idle timeout is assumed to be complete. </td></tr>
    <tr><td class="paramname">active_ms</td><td>active timeout in milliseconds. The maximum duration of a flow is the active timeout; additional packets for the same flow will be counted as part of a new flow. </td></tr>
    <tr><td class="paramname">max_flows</td><td>maximum number of active flows. Flows exceeding this limit will be expired in least-recent order, as if they were idle. Used to limit resource usage of a flow table. A value of 0 disables flow count limits. </td></tr>
    <tr><td class="paramname">max_payload</td><td>maximum octets of payload to capture per flow direction. Requires at least max_payload octets of payload to be available in each packet buffer passed to <a class="el" href="yaftab_8h.html#ab37f151a4c4f8428eaf11655ec54be64" title="Add a decoded packet buffer to a given flow table. ">yfFlowPBuf()</a>. A value of 0 disables payload capture and export. </td></tr>
    <tr><td class="paramname">uniflow</td><td>If TRUE, export biflows using record adjacency (two uniflows exported back-to-back. Use this for interoperability with IPFIX collectors that do not implement RFC 5103. </td></tr>
    <tr><td class="paramname">silkmode</td><td>If TRUE, clamp totalOctetCount and maxTotalOctetCount to 32 bits and force active timeout on overflow. Set high order bit in flowEndReason for each flow created on an overflow or active timeout. Breaks IPFIX interoperability; use for direct export to SiLK rwflowpack or flowcap.</td></tr>
    <tr><td class="paramname">macmode</td><td>If TRUE, collect and export source and destination Mac Addresses. </td></tr>
    <tr><td class="paramname">applabelmode</td><td>If TRUE, then the payload, (as limited by max_payload,) is sent through various plugins and code in order to determine which protocol is running on the flow by doing only payload inspection and exporting payload relevent information.</td></tr>
    <tr><td class="paramname">entropymode</td><td>If TRUE, then a Shannon Entropy measurement is made over the captured payload (as limited by max_payload). The entropy value is exported as two values one for forward payload and one for reverse payload.</td></tr>
    <tr><td class="paramname">fingerprintmode</td><td>If TRUE, then this will enable passive OS finger printing using the p0f engine based mostly on TCP negotiation</td></tr>
    <tr><td class="paramname">fpExportMode</td><td>If TRUE, then this will enable exporting of full packet banners of the TCP negotiations for the first three packets (including IP and transport headers) for external fingerprinting</td></tr>
    <tr><td class="paramname">udp_max_payload</td><td>If TRUE, then this will enable capturing up to max_payload value for udp flows (instead of just the first packet)</td></tr>
    <tr><td class="paramname">udp_uniflow_port</td><td>If not 0, then this will enable exporting a single UDP packet with this src/dst port as a flow.</td></tr>
    <tr><td class="paramname">pcap_dir</td><td>Directory to put pcap-per-flow files</td></tr>
    <tr><td class="paramname">pcap_meta_file</td><td>File for pcap meta output. Default is stdout</td></tr>
    <tr><td class="paramname">max_pcap</td><td>Maximum size [in bytes] of a pcap file before rotating.</td></tr>
    <tr><td class="paramname">pcap_per_flow</td><td>If TRUE, then pcap_dir will be set to the directory to place pcap-per-flow files. </td></tr>
    <tr><td class="paramname">force_read_all</td><td>If TRUE, then yaf will process files that are out of sequence. </td></tr>
    <tr><td class="paramname">stats_mode</td><td>If TRUE, then YAF will do some extra calculations on flows. </td></tr>
    <tr><td class="paramname">index_pcap</td><td>If TRUE, print one line per packet we export. This will give offset and length into the pcap yaf writes. </td></tr>
    <tr><td class="paramname">no_vlan_in_key</td><td>If TRUE, this will remove the vlan in the calculation of the flow key hash. </td></tr>
    <tr><td class="paramname">ndpi</td><td>If TRUE, enable nDPI application labeling with standard protocols. </td></tr>
    <tr><td class="paramname">ndpi_proto_file</td><td>If not NULL, and ndpi is TRUE, use the provided protocol file to expand the sub-protocols list and port-based detection methods. </td></tr>
    <tr><td class="paramname">hash</td><td>The flow key hash to create a PCAP for. </td></tr>
    <tr><td class="paramname">stime</td><td>The start time to create a PCAP for. </td></tr>
    <tr><td class="paramname">hfctx</td><td>The plugin hooks context variable (NULL if plugins not enabled)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a new flow table. </dd></dl>

</div>
</div>
<a class="anchor" id="a1a53e42d3ae005b47da77a6e4a6695e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t yfFlowTabCurrentTime </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *&#160;</td>
          <td class="paramname"><em>flowtab</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current packet clock from a flow table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flowtab</td><td>a flow table </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>current packet clock </dd></dl>

</div>
</div>
<a class="anchor" id="a6a423cb1a664ab1bffc3c5a87f184215"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfFlowTabFlush </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>yfContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>close</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flush closed flows in the given flow table to the given IPFIX Message Buffer. </p>
<p>Causes any idle flows to time out, removing them from the active flow table; also enforces the flow table's resource limit. If close is TRUE, additionally closes all active flows and flushes as well.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">yfContext</td><td>YAF thread context structure, holds pointers for the flowtable from which to flush flows and the fbuf, the destination to which the flows should be flushed </td></tr>
    <tr><td class="paramname">close</td><td>close all active flows before flushing </td></tr>
    <tr><td class="paramname">err</td><td>An error description pointer; must not be NULL. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE on success, FALSE otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="a561a2425c34f20c77c9237ca6e9812d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfFlowTabFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *&#160;</td>
          <td class="paramname"><em>flowtab</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free a previously allocated flow table. </p>
<p>Discards any outstanding active flows without closing or flushing them; use yfFlowTabFlushAll() before yfFlowFree() to do this.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flowtab</td><td>a flow table allocated by <a class="el" href="yaftab_8h.html#a270b166611ccdb1e647ac9597f038227" title="yfFlowTabAlloc ">yfFlowTabAlloc()</a> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8c9736e80ac4b9e1f99c9eeaf6f51bef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfGetFlowTabStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *&#160;</td>
          <td class="paramname"><em>flowtab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>packets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>flows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>rej_pkts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>peak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>flush</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>yfGetFlowTabStats Get Flow Table Stats for Export </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flowtab</td><td></td></tr>
    <tr><td class="paramname">packets</td><td>number of packets processed </td></tr>
    <tr><td class="paramname">flows</td><td>number of flows created </td></tr>
    <tr><td class="paramname">rej_pkts</td><td>number of packets rejected due to out of sequence </td></tr>
    <tr><td class="paramname">peak</td><td>maximum number of flows in the flow table at any 1 time </td></tr>
    <tr><td class="paramname">flush</td><td>number of flush events called on flow table </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a416a4a18ac082b8d90c3f303b2d48329"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfUpdateRollingPcapFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *&#160;</td>
          <td class="paramname"><em>flowtab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>new_file_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the Pcap Filename in the Flowtab for pcap meta data output. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flowtab</td><td>pointer to flow table </td></tr>
    <tr><td class="paramname">new_file_name</td><td>the filename of the next pcap file to write to </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
      </div><!-- l-content -->
      <div id="l-footer">&copy; 2006-2016 Carnegie Mellon University</div>
    </div><!-- p-body -->
</body>
</html>   
