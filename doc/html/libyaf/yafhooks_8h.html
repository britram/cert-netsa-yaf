<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>YAF - Documentation</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <link rel="stylesheet" type="text/css" href="doxygen.css">
        <link rel="stylesheet" type="text/css" href="../../site/style.css" />
        <link rel="stylesheet" type="text/css" href="tabs.css">
</head>
<body>
    <div id="p-body">
      <div id="l-header">
        <img src="../../site/sei-logo.png" id="l-sei-logo"
            alt="Software Engineering Institute | Carnegie Mellon&copy;" />
        <div id="l-netsa-logo"><a id="l-netsa-name" href="../../index.html"><b>CERT NetSA Security Suite</b></a></div>
        <div id="l-netsa-motto">Monitoring for Large-Scale Networks</div>
        <h1 class="l-page-title">YAF</h1>
        <span id="l-subtitle">Documentation</span>
      </div><!-- l-header -->
      <div id="l-content">
        <div id="l-sidebar">
          <div class="p-sidebar-section">
            <h1><a href="index.html">YAF</a></h1>
            <ul>
              <li><a href="../docs.html">Documentation</a></li>
              <li><a href="../download.html">Downloads</a></li>
            </ul>
          </div><!-- p-sidebar-section -->
        </div><!-- l-sidebar -->
      <div id="top"> <!-- need this for doxygen -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Tutorials</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_615759f7aa2b23f9d732a2fd184cb668.html">yaf</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">yafhooks.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;yaf/autoinc.h&gt;</code><br />
<code>#include &lt;yaf/decode.h&gt;</code><br />
<code>#include &lt;<a class="el" href="yafcore_8h_source.html">yaf/yafcore.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="yaftab_8h_source.html">yaf/yaftab.h</a>&gt;</code><br />
</div>
<p><a href="yafhooks_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structyf_hook_meta_data.html">yfHookMetaData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exported from the plugin to tell YAF about its export data &amp; interface version.  <a href="structyf_hook_meta_data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6f5462653bd733272e147c5cdab88392"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6f5462653bd733272e147c5cdab88392"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a6f5462653bd733272e147c5cdab88392">YAF_HOOK_INTERFACE_VERSION</a>&#160;&#160;&#160;6</td></tr>
<tr class="memdesc:a6f5462653bd733272e147c5cdab88392"><td class="mdescLeft">&#160;</td><td class="mdescRight">HOOKS Plugin Version. <br /></td></tr>
<tr class="separator:a6f5462653bd733272e147c5cdab88392"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acd19221bcb828e3b205ac1d1bae67dd5"><td class="memItemLeft" align="right" valign="top">gboolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#acd19221bcb828e3b205ac1d1bae67dd5">yfHookPacket</a> (<a class="el" href="yafcore_8h.html#a772bfd1d76b8f135ed7fcaf59468eb7b">yfFlowKey_t</a> *key, const uint8_t *pkt, size_t caplen, uint16_t iplen, <a class="el" href="structyf_t_c_p_info__st.html">yfTCPInfo_t</a> *tcpinfo, <a class="el" href="structyf_l2_info__st.html">yfL2Info_t</a> *l2info)</td></tr>
<tr class="memdesc:acd19221bcb828e3b205ac1d1bae67dd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function called to do processing on each packet as it comes in.  <a href="#acd19221bcb828e3b205ac1d1bae67dd5">More...</a><br /></td></tr>
<tr class="separator:acd19221bcb828e3b205ac1d1bae67dd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e57f87d6a93b48cc0936ae97cd947c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a4e57f87d6a93b48cc0936ae97cd947c3">yfHookFlowPacket</a> (<a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *flow, <a class="el" href="yafcore_8h.html#ac37f5df551c6f2d381848399300f6722">yfFlowVal_t</a> *val, const uint8_t *pkt, size_t caplen, uint16_t iplen, <a class="el" href="structyf_t_c_p_info__st.html">yfTCPInfo_t</a> *tcpinfo, <a class="el" href="structyf_l2_info__st.html">yfL2Info_t</a> *l2info)</td></tr>
<tr class="memdesc:a4e57f87d6a93b48cc0936ae97cd947c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Similar to yfHookPacket but also given yfFlowVal_t struct for processing per flow direction.  <a href="#a4e57f87d6a93b48cc0936ae97cd947c3">More...</a><br /></td></tr>
<tr class="separator:a4e57f87d6a93b48cc0936ae97cd947c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9cb8ca0bb783590930746c131847011"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#af9cb8ca0bb783590930746c131847011">yfHookValidateFlowTab</a> (void **yfctx, uint32_t max_payload, gboolean uniflow, gboolean silkmode, gboolean applabelmode, gboolean entropymode, gboolean fingerprintmode, gboolean fpExportMode, gboolean udp_max_payload, uint16_t udp_uniflow_port)</td></tr>
<tr class="memdesc:af9cb8ca0bb783590930746c131847011"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validation function to make sure the plugin can and should operate based on the flowtable options.  <a href="#af9cb8ca0bb783590930746c131847011">More...</a><br /></td></tr>
<tr class="separator:af9cb8ca0bb783590930746c131847011"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b801e783cc418a5d6b4625984a9557e"><td class="memItemLeft" align="right" valign="top">gboolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a9b801e783cc418a5d6b4625984a9557e">yfHookFlowClose</a> (<a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *flow)</td></tr>
<tr class="memdesc:a9b801e783cc418a5d6b4625984a9557e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called upon flow close to do any necessary plugin processing upon flow close.  <a href="#a9b801e783cc418a5d6b4625984a9557e">More...</a><br /></td></tr>
<tr class="separator:a9b801e783cc418a5d6b4625984a9557e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac628e362d15d7cb034343829668bfbcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#ac628e362d15d7cb034343829668bfbcf">yfHookFlowAlloc</a> (<a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *flow, void **yfctx)</td></tr>
<tr class="memdesc:ac628e362d15d7cb034343829668bfbcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow plugins to allocate flow state information for each flow captured by yaf at the time of flow creation.  <a href="#ac628e362d15d7cb034343829668bfbcf">More...</a><br /></td></tr>
<tr class="separator:ac628e362d15d7cb034343829668bfbcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a95321f578ab86b78f7e7c348e2b004"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a0a95321f578ab86b78f7e7c348e2b004">yfHookFlowFree</a> (<a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *flow)</td></tr>
<tr class="memdesc:a0a95321f578ab86b78f7e7c348e2b004"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees all memory associated with the flow state in all of the attached plugins.  <a href="#a0a95321f578ab86b78f7e7c348e2b004">More...</a><br /></td></tr>
<tr class="separator:a0a95321f578ab86b78f7e7c348e2b004"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a101e734c147bf121eacdc6e0b7e5487c"><td class="memItemLeft" align="right" valign="top">fbInfoElement_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a101e734c147bf121eacdc6e0b7e5487c">yfHookGetInfoModel</a> (void)</td></tr>
<tr class="memdesc:a101e734c147bf121eacdc6e0b7e5487c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the IPFIX info model aggregated for all plugins.  <a href="#a101e734c147bf121eacdc6e0b7e5487c">More...</a><br /></td></tr>
<tr class="separator:a101e734c147bf121eacdc6e0b7e5487c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f9d70dbb8a7a2ab72e82977be7b4596"><td class="memItemLeft" align="right" valign="top">gboolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a3f9d70dbb8a7a2ab72e82977be7b4596">yfHookGetTemplate</a> (fbSession_t *session)</td></tr>
<tr class="memdesc:a3f9d70dbb8a7a2ab72e82977be7b4596"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the IPFIX info model template for the export data from <em>all</em> the plugins and turns it into a single template to return.  <a href="#a3f9d70dbb8a7a2ab72e82977be7b4596">More...</a><br /></td></tr>
<tr class="separator:a3f9d70dbb8a7a2ab72e82977be7b4596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad791565736a87937fd8c4004bf9d7a51"><td class="memItemLeft" align="right" valign="top">gboolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#ad791565736a87937fd8c4004bf9d7a51">yfWriteFlowHook</a> (fbSubTemplateMultiList_t *rec, fbSubTemplateMultiListEntry_t *stml, <a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *flow, GError **err)</td></tr>
<tr class="memdesc:ad791565736a87937fd8c4004bf9d7a51"><td class="mdescLeft">&#160;</td><td class="mdescRight">called by yfWriteFlow to add the data from all registered plugins to the outgoing IPFIX record  <a href="#ad791565736a87937fd8c4004bf9d7a51">More...</a><br /></td></tr>
<tr class="separator:ad791565736a87937fd8c4004bf9d7a51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bbe4cceea2466b23053af3dfde1ad49"><td class="memItemLeft" align="right" valign="top">gboolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a3bbe4cceea2466b23053af3dfde1ad49">yfHookAddNewHook</a> (const char *hookName, const char *hookOpts, const char *hookConf, void **yfctx, GError **err)</td></tr>
<tr class="memdesc:a3bbe4cceea2466b23053af3dfde1ad49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds another hook (plugin) into yaf.  <a href="#a3bbe4cceea2466b23053af3dfde1ad49">More...</a><br /></td></tr>
<tr class="separator:a3bbe4cceea2466b23053af3dfde1ad49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a732a95ddea0e0d150ce418261ba1d115"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a732a95ddea0e0d150ce418261ba1d115">yfHookGetTemplateCount</a> (<a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *flow)</td></tr>
<tr class="memdesc:a732a95ddea0e0d150ce418261ba1d115"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the amount of templates to add to the SubtemplateMultiList from all plugins hooked.  <a href="#a732a95ddea0e0d150ce418261ba1d115">More...</a><br /></td></tr>
<tr class="separator:a732a95ddea0e0d150ce418261ba1d115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9416f3b5e9dcc40e47563622b645e7a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a9416f3b5e9dcc40e47563622b645e7a9">yfHookFreeLists</a> (<a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *flow)</td></tr>
<tr class="memdesc:a9416f3b5e9dcc40e47563622b645e7a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends control back to the plugin to free any BasicLists, SubTemplateLists, or SubTemplateMultiLists that may have been used in it's added templates.  <a href="#a9416f3b5e9dcc40e47563622b645e7a9">More...</a><br /></td></tr>
<tr class="separator:a9416f3b5e9dcc40e47563622b645e7a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Processing hook interface for YAF. </p>
<p>VERSION 3 - REQUIRES FIXBUF 1.0</p>
<p>The plugin must implement all of the following functions:</p>
<p>ypGetMetaData - returns the version, max export bytes, applabel enabled</p>
<p>ypHookPacket - called by <a class="el" href="yaftab_8h.html#ab37f151a4c4f8428eaf11655ec54be64" title="Add a decoded packet buffer to a given flow table. ">yfFlowPBuf()</a></p>
<p>ypFlowPacket - called by <a class="el" href="yaftab_8h.html#ab37f151a4c4f8428eaf11655ec54be64" title="Add a decoded packet buffer to a given flow table. ">yfFlowPBuf()</a> and yfAppLabelFlow() when called by yfAppLabelFlow - the last 3 parameters are 0</p>
<p>ypFlowClose - called by yfFlowClose()</p>
<p>ypFlowAlloc - called by yfFlowGetNode()</p>
<p>ypFlowFree - called by yfFlowFree()</p>
<p>ypGetInfoModel - called by yfInfoModel() - this should not be used for v.3</p>
<p>ypGetTemplate - called by yfInitExporterSession()</p>
<p>ypSetPluginOpt - called by <a class="el" href="yafhooks_8h.html#a3bbe4cceea2466b23053af3dfde1ad49" title="Adds another hook (plugin) into yaf. ">yfHookAddNewHook()</a></p>
<p>ypSetPluginConf - called by <a class="el" href="yafhooks_8h.html#a3bbe4cceea2466b23053af3dfde1ad49" title="Adds another hook (plugin) into yaf. ">yfHookAddNewHook()</a></p>
<p>ypScanPayload - if Application labeling is enabled, called by app plugins</p>
<p>ypValidateFlowTab - called by <a class="el" href="yaftab_8h.html#a270b166611ccdb1e647ac9597f038227" title="yfFlowTabAlloc ">yfFlowTabAlloc()</a></p>
<p>ypGetTemplateCount - called by <a class="el" href="yafcore_8h.html#a4aba445d9e6561395ee1a2de5a91ac15" title="Write a single flow to an IPFIX message buffer. ">yfWriteFlow()</a></p>
<p>ypFreeLists - called by <a class="el" href="yafcore_8h.html#a4aba445d9e6561395ee1a2de5a91ac15" title="Write a single flow to an IPFIX message buffer. ">yfWriteFlow()</a> </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a3bbe4cceea2466b23053af3dfde1ad49"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfHookAddNewHook </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hookName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hookOpts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hookConf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>yfctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds another hook (plugin) into yaf. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hookName</td><td>the file name of the plugin to load </td></tr>
    <tr><td class="paramname">hookOpts</td><td>a string of command line options for the plugin to process </td></tr>
    <tr><td class="paramname">hookConf</td><td>the config file for the plugin </td></tr>
    <tr><td class="paramname">yfctx</td><td>pointer to the yaf ctx which contains configuration specifics for this instance of yaf </td></tr>
    <tr><td class="paramname">err</td><td>the error value that gets set if this call didn't work</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if plugin loaded fine, other FALSE </dd></dl>

</div>
</div>
<a class="anchor" id="ac628e362d15d7cb034343829668bfbcf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfHookFlowAlloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>yfctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allow plugins to allocate flow state information for each flow captured by yaf at the time of flow creation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flow</td><td>the pointer to the flow context state structure, but more importantly contains the array of pointers (hfctx) which hold the plugin context state </td></tr>
    <tr><td class="paramname">yfctx</td><td>pointer to the yaf ctx which contains configuration specifics for this instance of yaf </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9b801e783cc418a5d6b4625984a9557e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfHookFlowClose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called upon flow close to do any necessary plugin processing upon flow close. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flow</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE or FALSE upon error </dd></dl>

</div>
</div>
<a class="anchor" id="a0a95321f578ab86b78f7e7c348e2b004"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfHookFlowFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees all memory associated with the flow state in all of the attached plugins. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flow</td><td>- a pointer to the flow context structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4e57f87d6a93b48cc0936ae97cd947c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfHookFlowPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yafcore_8h.html#ac37f5df551c6f2d381848399300f6722">yfFlowVal_t</a> *&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>iplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_t_c_p_info__st.html">yfTCPInfo_t</a> *&#160;</td>
          <td class="paramname"><em>tcpinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_l2_info__st.html">yfL2Info_t</a> *&#160;</td>
          <td class="paramname"><em>l2info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Similar to yfHookPacket but also given yfFlowVal_t struct for processing per flow direction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flow</td><td>pointer to yfFlow_t </td></tr>
    <tr><td class="paramname">val</td><td>pointer to yfFlowVal_t struct </td></tr>
    <tr><td class="paramname">pkt</td><td>pointer to pkt data </td></tr>
    <tr><td class="paramname">caplen</td><td>size of pkt data </td></tr>
    <tr><td class="paramname">iplen</td><td></td></tr>
    <tr><td class="paramname">tcpinfo</td><td></td></tr>
    <tr><td class="paramname">l2info</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9416f3b5e9dcc40e47563622b645e7a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfHookFreeLists </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends control back to the plugin to free any BasicLists, SubTemplateLists, or SubTemplateMultiLists that may have been used in it's added templates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flow</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a101e734c147bf121eacdc6e0b7e5487c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fbInfoElement_t* yfHookGetInfoModel </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the IPFIX info model aggregated for all plugins. </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to an array of fbInfoElement_t that contains the sum of the IPFIX IE's from all active plugins </dd></dl>

</div>
</div>
<a class="anchor" id="a3f9d70dbb8a7a2ab72e82977be7b4596"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfHookGetTemplate </td>
          <td>(</td>
          <td class="paramtype">fbSession_t *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the IPFIX info model template for the export data from <em>all</em> the plugins and turns it into a single template to return. </p>
<p>It caches the results so that future queries are a lot faster. It can validate the cached result if the numer of plugins registered changes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>pointer to an array of fbInfoElementSpec_t structures that describes the info model template </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a732a95ddea0e0d150ce418261ba1d115"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t yfHookGetTemplateCount </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the amount of templates to add to the SubtemplateMultiList from all plugins hooked. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flow</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of templates to add to SubTemplateMultiList in yaf </dd></dl>

</div>
</div>
<a class="anchor" id="acd19221bcb828e3b205ac1d1bae67dd5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfHookPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yafcore_8h.html#a772bfd1d76b8f135ed7fcaf59468eb7b">yfFlowKey_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>iplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_t_c_p_info__st.html">yfTCPInfo_t</a> *&#160;</td>
          <td class="paramname"><em>tcpinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_l2_info__st.html">yfL2Info_t</a> *&#160;</td>
          <td class="paramname"><em>l2info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function called to do processing on each packet as it comes in. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>pointer to flowkey </td></tr>
    <tr><td class="paramname">pkt</td><td>pointer to pkt data </td></tr>
    <tr><td class="paramname">caplen</td><td>size of pkt data </td></tr>
    <tr><td class="paramname">iplen</td><td></td></tr>
    <tr><td class="paramname">tcpinfo</td><td></td></tr>
    <tr><td class="paramname">l2info</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if pkt processing should continue, FALSE if not </dd></dl>

</div>
</div>
<a class="anchor" id="af9cb8ca0bb783590930746c131847011"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfHookValidateFlowTab </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>yfctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>max_payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>uniflow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>silkmode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>applabelmode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>entropymode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>fingerprintmode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>fpExportMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>udp_max_payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>udp_uniflow_port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validation function to make sure the plugin can and should operate based on the flowtable options. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">yfctx</td><td>pointer to the yaf ctx which contains configuration specifics </td></tr>
    <tr><td class="paramname">max_payload</td><td>value </td></tr>
    <tr><td class="paramname">uniflow</td><td></td></tr>
    <tr><td class="paramname">silkmode</td><td></td></tr>
    <tr><td class="paramname">applabelmode</td><td></td></tr>
    <tr><td class="paramname">entropymode</td><td></td></tr>
    <tr><td class="paramname">fingerprintmode</td><td>p0f finger printing mode </td></tr>
    <tr><td class="paramname">fpExportMode</td><td>handshake header export mode </td></tr>
    <tr><td class="paramname">udp_max_payload</td><td>concatenate udp payloads similar to TCP </td></tr>
    <tr><td class="paramname">udp_uniflow_port</td><td>export all udp packets if have this src or dst port </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad791565736a87937fd8c4004bf9d7a51"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfWriteFlowHook </td>
          <td>(</td>
          <td class="paramtype">fbSubTemplateMultiList_t *&#160;</td>
          <td class="paramname"><em>rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fbSubTemplateMultiListEntry_t *&#160;</td>
          <td class="paramname"><em>stml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>called by yfWriteFlow to add the data from all registered plugins to the outgoing IPFIX record </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rec</td><td>outgoing subTemplateMultiList </td></tr>
    <tr><td class="paramname">stml</td><td>Current entry of subTemplateMultiList </td></tr>
    <tr><td class="paramname">flow</td><td>pointer to the flow context structure </td></tr>
    <tr><td class="paramname">err</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
      </div><!-- l-content -->
      <div id="l-footer">&copy; 2006-2016 Carnegie Mellon University</div>
    </div><!-- p-body -->
</body>
</html>   
